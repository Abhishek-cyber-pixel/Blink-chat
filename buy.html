<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Manager with Permanent Links</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    header {
      background: #4a6fa5;
      color: white;
      padding: 25px;
      text-align: center;
    }
    
    h1 {
      font-size: 2.2rem;
      margin-bottom: 10px;
    }
    
    .subtitle {
      font-size: 1rem;
      opacity: 0.9;
    }
    
    .main-content {
      padding: 25px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 25px;
    }
    
    @media (min-width: 900px) {
      .main-content {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .upload-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      border: 2px dashed #dae1e8;
    }
    
    .file-input-wrapper {
      position: relative;
      display: inline-block;
      margin: 15px 0;
    }
    
    .file-input-wrapper input[type="file"] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    
    .file-input-button {
      display: inline-block;
      padding: 12px 25px;
      background: #4a6fa5;
      color: white;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(74, 111, 165, 0.3);
    }
    
    .file-input-button:hover {
      background: #3a5a80;
      transform: translateY(-2px);
    }
    
    .file-name {
      margin-top: 10px;
      font-size: 0.9rem;
      color: #666;
    }
    
    .status {
      padding: 12px;
      margin: 15px 0;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
    }
    
    .status.success {
      background: #e6f7ee;
      color: #2e7d52;
      border: 1px solid #b7e4c7;
    }
    
    .status.error {
      background: #ffe6e6;
      color: #c53030;
      border: 1px solid #f5c6cb;
    }
    
    .pdf-viewer {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
      min-height: 400px;
    }
    
    .pdf-viewer iframe {
      width: 100%;
      height: 400px;
      border: none;
    }
    
    .no-preview {
      text-align: center;
      padding: 40px;
      color: #666;
      height: 400px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .no-preview i {
      font-size: 3rem;
      color: #ccc;
      margin-bottom: 15px;
    }
    
    .stored-pdfs {
      grid-column: 1 / -1;
    }
    
    .stored-pdfs h3 {
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #eaeaea;
    }
    
    .pdf-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
    }
    
    .pdf-item {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      border: 1px solid #eaeaea;
      transition: transform 0.2s;
    }
    
    .pdf-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .pdf-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .pdf-item-name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 600;
    }
    
    .pdf-size {
      font-size: 0.8rem;
      color: #666;
      margin-left: 10px;
    }
    
    .pdf-link-container {
      display: flex;
      margin: 10px 0;
      background: white;
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid #ddd;
    }
    
    .pdf-link {
      flex: 1;
      padding: 8px 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 0.85rem;
      background: #f9f9f9;
    }
    
    .copy-btn {
      padding: 8px 12px;
      background: #4a6fa5;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .copy-btn:hover {
      background: #3a5a80;
    }
    
    .pdf-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    .btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .btn-view {
      background: #4a6fa5;
      color: white;
    }
    
    .btn-delete {
      background: #f44336;
      color: white;
    }
    
    .btn:hover {
      opacity: 0.9;
      transform: scale(1.05);
    }
    
    .empty-list {
      text-align: center;
      padding: 40px 20px;
      color: #888;
      font-style: italic;
      grid-column: 1 / -1;
    }
    
    footer {
      text-align: center;
      padding: 20px;
      color: #666;
      font-size: 0.9rem;
      border-top: 1px solid #eaeaea;
      margin-top: 30px;
    }
    
    .instructions {
      background: #e6f7ee;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #2e7d52;
    }
    
    .instructions h3 {
      margin-bottom: 10px;
      color: #2e7d52;
    }
    
    .instructions ol {
      margin-left: 20px;
    }
    
    .instructions li {
      margin-bottom: 8px;
    }
    
    .multi-upload {
      margin-top: 15px;
    }
    
    @media (max-width: 768px) {
      .container {
        border-radius: 10px;
      }
      
      header {
        padding: 20px 15px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .main-content {
        padding: 15px;
        grid-template-columns: 1fr;
      }
      
      .pdf-viewer iframe {
        height: 300px;
      }
      
      .pdf-list {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>PDF Manager with Permanent Links</h1>
      <p class="subtitle">Upload PDFs and generate permanent shareable links</p>
    </header>
    
    <div class="main-content">
      <div class="upload-section">
        <h2>Upload PDF Files</h2>
        <div class="file-input-wrapper">
          <div class="file-input-button">
            <i class="fas fa-file-upload"></i> Choose PDF Files
          </div>
          <input type="file" id="pdfUpload" accept="application/pdf" multiple>
        </div>
        <p class="file-name" id="fileName">No files chosen</p>
        
        <div class="multi-upload">
          <p>You can select multiple PDFs at once</p>
        </div>
      </div>
      
      <div class="pdf-viewer">
        <div id="noPreview" class="no-preview">
          <i class="fas fa-file-pdf"></i>
          <p>Upload a PDF to preview it here</p>
        </div>
        <iframe id="pdfFrame" style="display: none;"></iframe>
      </div>
      
      <div class="instructions">
        <h3>How to use:</h3>
        <ol>
          <li>Upload PDF files using the button (you can select multiple at once)</li>
          <li>Your PDFs will be stored in browser's memory</li>
          <li>Permanent shareable links will be generated for each PDF</li>
          <li>Copy the link to view your PDF anytime from this browser</li>
          <li>Export your PDF links for permanent access</li>
        </ol>
      </div>
      
      <div class="stored-pdfs">
        <div class="stored-pdfs-header">
          <h3>Your PDF Collection</h3>
          <button id="exportBtn" class="btn btn-view">
            <i class="fas fa-download"></i> Export Links
          </button>
        </div>
        <div id="pdfList" class="pdf-list">
          <div class="empty-list">No PDFs stored yet. Upload your first PDF to get started!</div>
        </div>
      </div>
    </div>
    
    <footer>
      <p>PDF Manager &copy; 2023 | For truly permanent links, consider using cloud storage services</p>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('pdfUpload');
      const fileName = document.getElementById('fileName');
      const pdfFrame = document.getElementById('pdfFrame');
      const noPreview = document.getElementById('noPreview');
      const pdfList = document.getElementById('pdfList');
      const exportBtn = document.getElementById('exportBtn');
      
      // Generate a unique ID for each PDF
      function generateID() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
      }
      
      // Load stored PDFs on page load
      loadStoredPDFs();
      
      fileInput.addEventListener('change', function() {
        const files = fileInput.files;
        
        if (files.length === 0) return;
        
        if (files.length === 1) {
          fileName.textContent = files[0].name;
        } else {
          fileName.textContent = `${files.length} files selected`;
        }
        
        // Process each file
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          
          if (file.type === 'application/pdf') {
            // Create a URL for the PDF file
            const fileURL = URL.createObjectURL(file);
            
            // If it's the first file, display it
            if (i === 0) {
              pdfFrame.src = fileURL;
              pdfFrame.style.display = 'block';
              noPreview.style.display = 'none';
            }
            
            // Store the PDF
            storePDF(file);
          } else {
            showStatus('❌ Please select only PDF files.', 'error');
          }
        }
      });
      
      function storePDF(file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          // Generate a unique ID for this PDF
          const pdfId = generateID();
          
          // Store the PDF in localStorage
          const pdfData = {
            id: pdfId,
            name: file.name,
            size: formatFileSize(file.size),
            type: file.type,
            data: e.target.result,
            lastModified: file.lastModified,
            uploadDate: new Date().toLocaleDateString(),
            timestamp: Date.now()
          };
          
          // Get existing PDFs or initialize empty array
          const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
          
          // Check if PDF with same name already exists
          const existingIndex = storedPDFs.findIndex(pdf => pdf.name === file.name);
          
          if (existingIndex !== -1) {
            // Replace existing PDF
            storedPDFs[existingIndex] = pdfData;
            showStatus(`✅ PDF updated: ${file.name}`, 'success');
          } else {
            // Add new PDF
            storedPDFs.unshift(pdfData);
            showStatus(`✅ PDF uploaded: ${file.name}`, 'success');
          }
          
          // Save back to localStorage
          localStorage.setItem('pdfs', JSON.stringify(storedPDFs));
          
          // Refresh the stored PDFs list
          loadStoredPDFs();
        };
        
        reader.readAsDataURL(file);
      }
      
      function loadStoredPDFs() {
        const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
        
        if (storedPDFs.length === 0) {
          pdfList.innerHTML = '<div class="empty-list">No PDFs stored yet. Upload your first PDF to get started!</div>';
          return;
        }
        
        pdfList.innerHTML = '';
        
        // Sort by timestamp (newest first)
        storedPDFs.sort((a, b) => b.timestamp - a.timestamp);
        
        storedPDFs.forEach((pdf, index) => {
          const pdfItem = document.createElement('div');
          pdfItem.className = 'pdf-item';
          
          // Create a URL for this PDF
          const viewUrl = `${window.location.origin}${window.location.pathname}?pdf=${pdf.id}`;
          
          pdfItem.innerHTML = `
            <div class="pdf-item-header">
              <div class="pdf-item-name" title="${pdf.name}">${pdf.name}</div>
              <div class="pdf-size">${pdf.size}</div>
            </div>
            <div>Uploaded: ${pdf.uploadDate}</div>
            <div class="pdf-link-container">
              <div class="pdf-link" title="${viewUrl}">${viewUrl}</div>
              <button class="copy-btn" data-url="${viewUrl}">
                <i class="fas fa-copy"></i>
              </button>
            </div>
            <div class="pdf-actions">
              <button class="btn btn-view" data-id="${pdf.id}">
                <i class="fas fa-eye"></i> View
              </button>
              <button class="btn btn-delete" data-index="${index}">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          `;
          
          pdfList.appendChild(pdfItem);
        });
        
        // Add event listeners to view buttons
        document.querySelectorAll('.btn-view').forEach(button => {
          button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
            const pdf = storedPDFs.find(p => p.id === id);
            
            if (pdf) {
              viewStoredPDF(pdf);
            }
          });
        });
        
        // Add event listeners to delete buttons
        document.querySelectorAll('.btn-delete').forEach(button => {
          button.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            deleteStoredPDF(index);
          });
        });
        
        // Add event listeners to copy buttons
        document.querySelectorAll('.copy-btn').forEach(button => {
          button.addEventListener('click', function() {
            const url = this.getAttribute('data-url');
            copyToClipboard(url);
          });
        });
        
        // Check if URL has a PDF parameter
        const urlParams = new URLSearchParams(window.location.search);
        const pdfParam = urlParams.get('pdf');
        
        if (pdfParam) {
          const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
          const pdf = storedPDFs.find(p => p.id === pdfParam);
          
          if (pdf) {
            viewStoredPDF(pdf);
          }
        }
      }
      
      function viewStoredPDF(pdf) {
        // Display the PDF
        pdfFrame.src = pdf.data;
        pdfFrame.style.display = 'block';
        noPreview.style.display = 'none';
        
        // Show success message
        showStatus(`✅ Now viewing: ${pdf.name}`, 'success');
        
        // Scroll to viewer
        pdfFrame.scrollIntoView({ behavior: 'smooth' });
      }
      
      function deleteStoredPDF(index) {
        const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
        
        // Remove the PDF
        const deletedPdf = storedPDFs.splice(index, 1)[0];
        
        // Save back to localStorage
        localStorage.setItem('pdfs', JSON.stringify(storedPDFs));
        
        // Refresh the list
        loadStoredPDFs();
        
        // Show message
        showStatus(`✅ PDF deleted: ${deletedPdf.name}`, 'success');
        
        // If we deleted the currently viewed PDF, clear the viewer
        if (pdfFrame.style.display === 'block') {
          pdfFrame.style.display = 'none';
          noPreview.style.display = 'block';
        }
      }
      
      // Export PDF links
      exportBtn.addEventListener('click', function() {
        const storedPDFs = JSON.parse(localStorage.getItem('pdfs')) || [];
        
        if (storedPDFs.length === 0) {
          showStatus('❌ No PDFs to export', 'error');
          return;
        }
        
        let exportData = "PDF Links Export\n\n";
        storedPDFs.forEach(pdf => {
          const viewUrl = `${window.location.origin}${window.location.pathname}?pdf=${pdf.id}`;
          exportData += `${pdf.name}\n${viewUrl}\n\n`;
        });
        
        const blob = new Blob([exportData], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = 'pdf_links_export.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showStatus('✅ PDF links exported successfully!', 'success');
      });
      
      function showStatus(message, type) {
        // Remove existing status if any
        const existingStatus = document.getElementById('status');
        if (existingStatus) {
          existingStatus.remove();
        }
        
        // Create status element
        const status = document.createElement('div');
        status.id = 'status';
        status.className = `status ${type}`;
        status.textContent = message;
        
        // Insert after upload section
        const uploadSection = document.querySelector('.upload-section');
        uploadSection.parentNode.insertBefore(status, uploadSection.nextSibling);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
          status.remove();
        }, 5000);
      }
      
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          showStatus('✅ Link copied to clipboard!', 'success');
        }).catch(err => {
          showStatus('❌ Failed to copy link', 'error');
        });
      }
      
      function formatFileSize(bytes) {
        if (bytes < 1024) return bytes + ' bytes';
        else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
        else return (bytes / 1048576).toFixed(1) + ' MB';
      }
    });
  </script>
</body>
</html>

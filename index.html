<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign In - AbhiLearn</title>
  <style>
    /* === INSERT YOUR CSS HERE (same as your original CSS code) === */
    :root {
      --primary-gradient: linear-gradient(-45deg, #6a11cb, #2575fc, #6a11cb, #2575fc);
      --button-gradient: linear-gradient(135deg, #ffcc00, #ff8800);
      --button-hover-gradient: linear-gradient(135deg, #fff, #ffcc00);
      --error-color: #ff4d4d;
      --success-color: #4dff4d;
      --link-color: #000000;
      --link-hover-color: #333333;
      --secondary-link-color: #000000;
      --card-bg: rgba(255,255,255,0.12);
      --text-color: #fff;
      --input-focus-glow: rgba(37,117,252,0.8);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: 'Segoe UI', sans-serif; overflow: hidden;
      min-height: 100vh; display: flex; justify-content: center;
      align-items: center; background: var(--primary-gradient);
      background-size: 400% 400%; animation: gradientMove 20s ease infinite;
      position: relative; color: var(--text-color);
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .form-container { width: 100%; max-width: 400px; padding: 0 15px; }
    .form-card {
      background: var(--card-bg); backdrop-filter: blur(12px); padding: 2rem;
      border-radius: 20px; text-align: center; width: 100%; position: relative;
      z-index: 10; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }
    .form-card h2 { font-size: 2rem; margin-bottom: 1.5rem;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    .input-group { margin-bottom: 1rem; position: relative; }
    .form-card input {
      width: 100%; padding: 14px 16px; border-radius: 10px;
      border: 2px solid transparent; outline: none; font-size: 1rem;
      background: rgba(255, 255, 255, 0.9); transition: all 0.3s ease;
    }
    .form-card input:focus {
      border-color: var(--input-focus-glow);
      box-shadow: 0 0 10px var(--input-focus-glow);
      background: rgba(255, 255, 255, 1);
    }
    .password-toggle {
      position: absolute; right: 12px; top: 50%;
      transform: translateY(-50%); background: none;
      border: none; cursor: pointer; color: #666; font-size: 0.9rem;
    }
    .btn {
      width: 100%; padding: 14px; margin-top: 15px;
      border: none; border-radius: 12px; font-weight: bold;
      cursor: pointer; background: var(--button-gradient);
      color: #333; transition: all 0.3s ease; font-size: 1rem;
    }
    .btn:hover {
      background: var(--button-hover-gradient);
      transform: translateY(-3px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    }
    .btn:active { transform: translateY(-1px); }
    #error-message, #success-message,
    #signup-error-message, #signup-success-message,
    #forgot-error-message, #forgot-success-message {
      margin-top: 12px; font-weight: bold;
      padding: 8px 12px; border-radius: 8px;
    }
    .error { color: var(--error-color); background: rgba(255, 77, 77, 0.1); }
    .success { color: var(--success-color); background: rgba(77, 255, 77, 0.1); }
    .form-links { margin-top: 1rem; display: flex;
      flex-direction: column; gap: 0.5rem;
    }
    .forgot-link, .create-link { text-align: right; }
    .forgot-link a, .create-link a, .form-links a {
      color: var(--link-color); font-size: 1rem; font-weight: 700;
      text-decoration: none; transition: all 0.3s;
    }
    .create-link a { color: var(--secondary-link-color); }
    .forgot-link a:hover, .create-link a:hover, .form-links a:hover {
      color: var(--link-hover-color);
      text-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
      text-decoration: underline;
    }
    .hidden { display: none; }
    .bubble {
      position: absolute; border-radius: 50%; background: rgba(255,255,255,0.15);
      box-shadow: 0 0 15px rgba(255,255,255,0.3); pointer-events: none;
      z-index: 1;
    }
    .password-strength {
      margin-top: 5px; font-size: 0.8rem; text-align: left;
      height: 20px;
    }
    .strength-weak { color: #ff4d4d; }
    .strength-medium { color: #ffcc00; }
    .strength-strong { color: #4dff4d; }
    .loading {
      display: inline-block; width: 20px; height: 20px;
      border: 3px solid rgba(255,255,255,.3); border-radius: 50%;
      border-top-color: #fff; animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @media (max-width: 500px) {
      .form-card { padding: 1.5rem; }
      .form-card h2 { font-size: 1.75rem; }
    }
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      .bubble { display: none; }
    }
  </style>
</head>
<body>

  <div class="form-container">
    <!-- Login Form -->
    <div class="form-card" id="login-form">
      <h2>üîí Sign In</h2>
      <div class="input-group">
        <input type="text" id="login-username" placeholder="Enter Username" required aria-label="Username">
      </div>
      <div class="input-group">
        <input type="password" id="login-password" placeholder="Enter Password" required aria-label="Password">
        <button type="button" class="password-toggle" aria-label="Show password">üëÅÔ∏è</button>
      </div>
      <div class="forgot-link">
        <a href="#" onclick="showForgotPassword(event)">Forgot Password?</a>
      </div>
      <button class="btn" onclick="login()" id="login-btn">Login</button>
      <div class="create-link">
        <a href="#" onclick="showSignup(event)">Create new account</a>
      </div>
      <p id="error-message" class="hidden"></p>
    </div>

    <!-- Signup Form -->
    <div class="form-card hidden" id="signup-form">
      <h2>üöÄ Create New Account</h2>
      <div class="input-group">
        <input type="email" id="signup-email" placeholder="Enter Email" required aria-label="Email">
      </div>
      <div class="input-group">
        <input type="text" id="signup-username" placeholder="Choose a Username" required aria-label="Username">
      </div>
      <div class="input-group">
        <input type="password" id="signup-password" placeholder="Create a Password" required aria-label="Password">
        <button type="button" class="password-toggle" aria-label="Show password">üëÅÔ∏è</button>
        <div class="password-strength" id="password-strength"></div>
      </div>
      <button class="btn" onclick="signup()" id="signup-btn">Sign Up</button>
      <div class="form-links">
        <a href="#" onclick="showLogin(event)">Already have an account? Sign In</a>
      </div>
      <p id="signup-error-message" class="hidden"></p>
      <p id="signup-success-message" class="hidden"></p>
    </div>

    <!-- Forgot Password Form -->
    <div class="form-card hidden" id="forgot-password-form">
      <h2>ü§î Forgot Password</h2>
      <div class="input-group">
        <input type="text" id="forgot-username" placeholder="Enter Your Username" required aria-label="Username">
      </div>
      <div class="input-group">
        <input type="email" id="forgot-email" placeholder="Enter Your Email" required aria-label="Email">
      </div>
      <button class="btn" onclick="recoverPassword()" id="recover-btn">Recover Password</button>
      <div class="form-links">
        <a href="#" onclick="showLogin(event)">Back to Sign In</a>
      </div>
      <p id="forgot-error-message" class="hidden"></p>
      <p id="forgot-success-message" class="hidden"></p>
    </div>
  </div>

<script>
  // Utility functions
  function $(id) { return document.getElementById(id); }
  function showMessage(el, msg, type) {
    el.textContent = msg; el.className = type; el.classList.remove('hidden');
  }
  function hideMessage(el) { el.classList.add('hidden'); }
  function validateEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
  }
  function checkPasswordStrength(password) {
    if (password.length < 8) return { strength: 0, text: 'Weak: Too short' };
    let strength = 0;
    if (password.length >= 8) strength++;
    if (/[a-z]/.test(password)) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/[0-9]/.test(password)) strength++;
    if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength++;
    if (strength < 2) return { strength:1, text:'Weak' };
    if (strength < 4) return { strength:2, text:'Medium' };
    return { strength:3, text:'Strong' };
  }

  // Form toggles
  const loginForm = $('login-form'), signupForm = $('signup-form'), forgotForm = $('forgot-password-form');

  function showLogin(e) { e && e.preventDefault(); loginForm.classList.remove('hidden'); signupForm.classList.add('hidden'); forgotForm.classList.add('hidden'); clearMessages(); }
  function showSignup(e) { e && e.preventDefault(); loginForm.classList.add('hidden'); signupForm.classList.remove('hidden'); forgotForm.classList.add('hidden'); clearMessages(); }
  function showForgotPassword(e) { e && e.preventDefault(); loginForm.classList.add('hidden'); signupForm.classList.add('hidden'); forgotForm.classList.remove('hidden'); clearMessages(); }

  function clearMessages() {
    ['error-message','signup-error-message','signup-success-message','forgot-error-message','forgot-success-message'].forEach(id => {
      $(id).textContent = ''; $(id).classList.add('hidden');
    });
  }

  // Default user
  if (!localStorage.getItem('users')) {
    const defaultUsers = [{
      email: 'default@abhilearn.com',
      username: 'Abhishek pant',
      password: '987654321'
    }];
    localStorage.setItem('users', JSON.stringify(defaultUsers));
  }

  // Login function
  function login() {
    const username = $('login-username').value.trim(), password = $('login-password').value.trim();
    const errorMessage = $('error-message'), loginBtn = $('login-btn');
    if (!username || !password) { showMessage(errorMessage, "Please fill in all fields", "error"); return; }
    const original = loginBtn.textContent;
    loginBtn.innerHTML = '<span class="loading"></span> Logging in...'; loginBtn.disabled = true;
    setTimeout(() => {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        localStorage.setItem("isLoggedIn","true"); localStorage.setItem("currentUser", username);
        showMessage(errorMessage, "‚úÖ Login successful! Redirecting...", "success");
        setTimeout(() => window.location.href = "index2.html", 1000);
      } else {
        showMessage(errorMessage, "‚ùå Invalid Username or Password!", "error");
        loginBtn.textContent = original; loginBtn.disabled = false;
      }
    }, 800);
  }

  // Signup function
  function signup() {
    const email = $('signup-email').value.trim(), username = $('signup-username').value.trim();
    const password = $('signup-password').value.trim(), err = $('signup-error-message'), succ = $('signup-success-message');
    const btn = $('signup-btn');
    if (!email || !username || !password) { showMessage(err, "Please fill out all fields.", "error"); hideMessage(succ); return; }
    if (!validateEmail(email)) { showMessage(err, "Please enter a valid email address.", "error"); hideMessage(succ); return; }
    const ps = checkPasswordStrength(password);
    if (ps.strength < 2) { showMessage(err, "Password is too weak. Use at least 8 characters with a mix.", "error"); hideMessage(succ); return; }
    const original = btn.textContent;
    btn.innerHTML = '<span class="loading"></span> Creating account...'; btn.disabled = true;
    setTimeout(() => {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      if (users.some(u => u.username === username)) { showMessage(err, "‚ùå Username is already taken.", "error"); hideMessage(succ); btn.textContent = original; btn.disabled = false; return; }
      if (users.some(u => u.email === email)) { showMessage(err, "‚ùå An account with this email exists.", "error"); hideMessage(succ); btn.textContent = original; btn.disabled = false; return; }
      users.push({ email, username, password });
      localStorage.setItem('users', JSON.stringify(users));
      showMessage(succ, "‚úÖ Account created successfully! You can now sign in.", "success"); hideMessage(err);
      $('signup-email').value = ''; $('signup-username').value = ''; $('signup-password').value = '';
      btn.textContent = original; btn.disabled = false;
    }, 800);
  }

  // Recover password
  function recoverPassword() {
    const username = $('forgot-username').value.trim(), email = $('forgot-email').value.trim();
    const err = $('forgot-error-message'), succ = $('forgot-success-message');
    const btn = $('recover-btn');
    if (!username || !email) { showMessage(err, "Please enter both username and email.", "error"); hideMessage(succ); return; }
    if (!validateEmail(email)) { showMessage(err, "Please enter a valid email address.", "error"); hideMessage(succ); return; }
    const original = btn.textContent;
    btn.innerHTML = '<span class="loading"></span> Recovering...'; btn.disabled = true;
    setTimeout(() => {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.username === username && u.email === email);
      if (user) {
        showMessage(succ, `üîë Your password is: ${user.password}`, "success"); hideMessage(err);
      } else {
        showMessage(err, "‚ùå No account found with that username and email.", "error"); hideMessage(succ);
      }
      btn.textContent = original; btn.disabled = false;
    }, 800);
  }

  // Password toggle and strength listener
  document.querySelectorAll('.password-toggle').forEach(btn =>
    btn.addEventListener('click', function(){
      const input = this.previousElementSibling;
      if (input.type === 'password') { input.type = 'text'; this.textContent = 'üîí'; this.setAttribute('aria-label','Hide password'); }
      else { input.type = 'password'; this.textContent = 'üëÅÔ∏è'; this.setAttribute('aria-label','Show password'); }
    })
  );
  $('signup-password').addEventListener('input', function(){
    const el = $('password-strength');
    const password = this.value;
    if (!password) { el.textContent = ''; return; }
    const ps = checkPasswordStrength(password);
    el.textContent = ps.text;
    el.className = 'password-strength ' + (ps.strength === 1 ? 'strength-weak' : ps.strength === 2 ? 'strength-medium' : 'strength-strong');
  });

  // Enter key submit
  document.addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
      if (!signupForm.classList.contains("hidden")) signup();
      else if (!forgotForm.classList.contains("hidden")) recoverPassword();
      else login();
    }
  });

  // Bubbles animation
  function createBubble() {
    const b = document.createElement('div');
    b.classList.add('bubble');
    const size = 40 + Math.random()*80;
    b.style.width = b.style.height = size + 'px';
    b.style.left = Math.random()*window.innerWidth + 'px';
    b.style.top = Math.random()*window.innerHeight + 'px';
    document.body.appendChild(b);
    const driftX = (Math.random() - 0.5) * 300;
    const duration = 8000 + Math.random()*4000;
    b.animate([{ transform: 'translate(0,0)', opacity: 0.8 },
               { transform: `translate(${driftX}px, -${window.innerHeight + size}px)`, opacity: 0 }],
               { duration, easing: 'linear' });
    setTimeout(() => b.remove(), duration);
  }
  const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
  setInterval(() => {
    for (let i = 0; i < (isMobile ? 1 : 3); i++) createBubble();
  }, 1500);

  // Initialize
  showLogin();
</script>
</body>
</html>

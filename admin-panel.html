<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - AbhiLearn</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { 
    font-family: 'Poppins', sans-serif; 
    background: linear-gradient(135deg, #1a2a6c 0%, #2a5298 100%); 
    color:#fff; 
    min-height:100vh; 
    line-height: 1.6;
    padding: 20px;
}

.admin-container {
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 30px;
    backdrop-filter: blur(10px);
}

.admin-header {
    text-align: center;
    margin-bottom: 30px;
}

.admin-header h1 {
    color: #00ffcc;
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.admin-header p {
    color: rgba(255,255,255,0.8);
}

.add-book-form {
    background: rgba(255,255,255,0.05);
    padding: 30px;
    border-radius: 10px;
    margin-bottom: 30px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #00ffcc;
}

.form-group input, .form-group textarea, .form-group select {
    width: 100%;
    padding: 12px;
    border: 1px solid rgba(255,255,255,0.3);
    background: rgba(255,255,255,0.1);
    color: #fff;
    border-radius: 5px;
    font-size: 1rem;
}

.form-group textarea {
    height: 100px;
    resize: vertical;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

/* Multiple Images Section */
.multiple-images {
    background: rgba(255,255,255,0.05);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
}

.image-url-group {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

.image-url-group input {
    flex: 1;
}

.add-more-btn {
    background: #ffeb3b;
    color: #1a2a6c;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    margin-top: 10px;
}

.remove-image {
    background: #ff3366;
    color: white;
    border: none;
    padding: 12px 15px;
    border-radius: 5px;
    cursor: pointer;
}

.preview-images {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 15px;
}

.preview-img {
    width: 80px;
    height: 80px;
    object-fit: cover;
    border-radius: 5px;
    border: 2px solid #00ffcc;
}

.submit-btn {
    background: linear-gradient(to right, #00ffcc, #00b3b3);
    color: #1e3c72;
    border: none;
    padding: 15px 30px;
    border-radius: 8px;
    font-weight: 600;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
}

.submit-btn:hover {
    background: linear-gradient(to right, #00e6b8, #009999);
    transform: translateY(-2px);
}

.books-list {
    margin-top: 30px;
}

.books-list h2 {
    color: #00ffcc;
    margin-bottom: 20px;
    text-align: center;
}

.book-item {
    background: rgba(255,255,255,0.05);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 15px;
}

.book-info h3 {
    color: #00ffcc;
    margin-bottom: 5px;
}

.book-images-preview {
    display: flex;
    gap: 10px;
    margin: 10px 0;
    flex-wrap: wrap;
}

.book-img-preview {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 5px;
}

.book-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.edit-btn, .delete-btn {
    padding: 8px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
}

.edit-btn {
    background: #ffeb3b;
    color: #1a2a6c;
}

.delete-btn {
    background: #ff3366;
    color: white;
}

.empty-books {
    text-align: center;
    padding: 40px;
    color: rgba(255,255,255,0.7);
}

.empty-books i {
    font-size: 3rem;
    margin-bottom: 15px;
    color: rgba(255,255,255,0.3);
}

.back-btn {
    display: inline-block;
    margin-bottom: 20px;
    color: #00ffcc;
    text-decoration: none;
    font-weight: 600;
}

.back-btn:hover {
    text-decoration: underline;
}
</style>
</head>
<body>

<a href="buy.html" class="back-btn">‚Üê Back to Marketplace</a>

<div class="admin-container">
    <div class="admin-header">
        <h1>üìö Book Admin Panel</h1>
        <p>Add multiple images for each book</p>
    </div>

    <div class="add-book-form">
        <h2>Add New Book</h2>
        <form id="bookForm">
            <div class="form-group">
                <label for="bookTitle">Book Title *</label>
                <input type="text" id="bookTitle" required>
            </div>
            
            <div class="form-group">
                <label for="bookAuthor">Author *</label>
                <input type="text" id="bookAuthor" required>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="currentPrice">Current Price (‚Çπ) *</label>
                    <input type="number" id="currentPrice" required>
                </div>
                
                <div class="form-group">
                    <label for="originalPrice">Original Price (‚Çπ) *</label>
                    <input type="number" id="originalPrice" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="bookRating">Rating (0-5) *</label>
                    <input type="number" id="bookRating" min="0" max="5" step="0.1" required>
                </div>
                
                <div class="form-group">
                    <label for="ratingCount">Rating Count *</label>
                    <input type="number" id="ratingCount" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="bookDescription">Description *</label>
                <textarea id="bookDescription" required></textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="bookPublisher">Publisher *</label>
                    <input type="text" id="bookPublisher" required>
                </div>
                
                <div class="form-group">
                    <label for="bookEdition">Edition *</label>
                    <input type="text" id="bookEdition" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="bookPages">Pages *</label>
                    <input type="number" id="bookPages" required>
                </div>
                
                <div class="form-group">
                    <label for="bookLanguage">Language *</label>
                    <input type="text" id="bookLanguage" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="bookCondition">Condition *</label>
                    <select id="bookCondition" required>
                        <option value="New">New</option>
                        <option value="Like New">Like New</option>
                        <option value="Good">Good</option>
                        <option value="Acceptable">Acceptable</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="bookCategory">Category *</label>
                    <select id="bookCategory" required>
                        <option value="Engineering">Engineering</option>
                        <option value="Medical">Medical</option>
                        <option value="Commerce">Commerce</option>
                        <option value="Arts">Arts</option>
                        <option value="Science">Science</option>
                    </select>
                </div>
            </div>
            
            <!-- Multiple Images Section -->
            <div class="multiple-images">
                <h3>Book Images</h3>
                <p>First image will be shown as main image. Add more for detailed view.</p>
                
                <div id="imageUrlsContainer">
                    <div class="image-url-group">
                        <input type="url" class="image-url" placeholder="https://example.com/front-image.jpg" required>
                    </div>
                </div>
                
                <button type="button" class="add-more-btn" onclick="addMoreImageField()">
                    <i class="fas fa-plus"></i> Add More Images
                </button>
                
                <div class="preview-images" id="imagePreview">
                    <!-- Image previews will appear here -->
                </div>
            </div>
            
            <button type="submit" class="submit-btn">Add Book</button>
        </form>
    </div>

    <div class="books-list">
        <h2>Manage Existing Books</h2>
        <div id="booksList">
            <!-- Books will be displayed here -->
        </div>
    </div>
</div>

<script>
// Load existing books from localStorage
let books = JSON.parse(localStorage.getItem('abhiLearnBooks')) || [];

// Add more image fields
function addMoreImageField() {
    const container = document.getElementById('imageUrlsContainer');
    const newField = document.createElement('div');
    newField.className = 'image-url-group';
    newField.innerHTML = `
        <input type="url" class="image-url" placeholder="https://example.com/another-image.jpg">
        <button type="button" class="remove-image" onclick="removeImageField(this)">√ó</button>
    `;
    container.appendChild(newField);
}

// Remove image field
function removeImageField(button) {
    button.parentElement.remove();
    updateImagePreview();
}

// Update image preview
function updateImagePreview() {
    const preview = document.getElementById('imagePreview');
    const imageUrls = document.querySelectorAll('.image-url');
    
    preview.innerHTML = '';
    
    imageUrls.forEach(input => {
        if (input.value) {
            const img = document.createElement('img');
            img.src = input.value;
            img.className = 'preview-img';
            img.onerror = function() {
                this.style.display = 'none';
            };
            preview.appendChild(img);
        }
    });
}

// Listen for URL changes
document.addEventListener('input', function(e) {
    if (e.target.classList.contains('image-url')) {
        updateImagePreview();
    }
});

// Form submission
document.getElementById('bookForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Get all image URLs
    const imageUrls = Array.from(document.querySelectorAll('.image-url'))
        .map(input => input.value)
        .filter(url => url.trim() !== '');
    
    if (imageUrls.length === 0) {
        alert('Please add at least one image URL');
        return;
    }
    
    const newBook = {
        id: Date.now(), // Unique ID
        title: document.getElementById('bookTitle').value,
        author: document.getElementById('bookAuthor').value,
        images: imageUrls, // Array of all images
        currentPrice: parseInt(document.getElementById('currentPrice').value),
        originalPrice: parseInt(document.getElementById('originalPrice').value),
        rating: parseFloat(document.getElementById('bookRating').value),
        ratingCount: parseInt(document.getElementById('ratingCount').value),
        description: document.getElementById('bookDescription').value,
        publisher: document.getElementById('bookPublisher').value,
        edition: document.getElementById('bookEdition').value,
        pages: parseInt(document.getElementById('bookPages').value),
        language: document.getElementById('bookLanguage').value,
        condition: document.getElementById('bookCondition').value,
        category: document.getElementById('bookCategory').value
    };
    
    books.push(newBook);
    localStorage.setItem('abhiLearnBooks', JSON.stringify(books));
    
    // Reset form
    document.getElementById('bookForm').reset();
    document.getElementById('imageUrlsContainer').innerHTML = `
        <div class="image-url-group">
            <input type="url" class="image-url" placeholder="https://example.com/front-image.jpg" required>
        </div>
    `;
    document.getElementById('imagePreview').innerHTML = '';
    
    // Update books list
    displayBooks();
    
    alert('Book added successfully!');
});

// Display books in admin panel
function displayBooks() {
    const booksList = document.getElementById('booksList');
    booksList.innerHTML = '';
    
    if (books.length === 0) {
        booksList.innerHTML = `
            <div class="empty-books">
                <i class="fas fa-book"></i>
                <h3>No books added yet</h3>
                <p>Add your first book using the form above</p>
            </div>
        `;
        return;
    }
    
    books.forEach((book, index) => {
        const bookItem = document.createElement('div');
        bookItem.className = 'book-item';
        bookItem.innerHTML = `
            <div class="book-info">
                <h3>${book.title}</h3>
                <p>by ${book.author} | ‚Çπ${book.currentPrice} | ${book.category}</p>
                <p>${book.images.length} images</p>
                <div class="book-images-preview">
                    ${book.images.map(img => `<img src="${img}" class="book-img-preview" onerror="this.style.display='none'">`).join('')}
                </div>
            </div>
            <div class="book-actions">
                <button class="edit-btn" onclick="editBook(${index})">Edit</button>
                <button class="delete-btn" onclick="deleteBook(${index})">Delete</button>
            </div>
        `;
        booksList.appendChild(bookItem);
    });
}

// Delete book function
function deleteBook(index) {
    if (confirm('Are you sure you want to delete this book?')) {
        books.splice(index, 1);
        localStorage.setItem('abhiLearnBooks', JSON.stringify(books));
        displayBooks();
    }
}

// Edit book function
function editBook(index) {
    const book = books[index];
    
    // Fill form with book data
    document.getElementById('bookTitle').value = book.title;
    document.getElementById('bookAuthor').value = book.author;
    document.getElementById('currentPrice').value = book.currentPrice;
    document.getElementById('originalPrice').value = book.originalPrice;
    document.getElementById('bookRating').value = book.rating;
    document.getElementById('ratingCount').value = book.ratingCount;
    document.getElementById('bookDescription').value = book.description;
    document.getElementById('bookPublisher').value = book.publisher;
    document.getElementById('bookEdition').value = book.edition;
    document.getElementById('bookPages').value = book.pages;
    document.getElementById('bookLanguage').value = book.language;
    document.getElementById('bookCondition').value = book.condition;
    document.getElementById('bookCategory').value = book.category;
    
    // Fill images
    const container = document.getElementById('imageUrlsContainer');
    container.innerHTML = '';
    book.images.forEach((url, i) => {
        const newField = document.createElement('div');
        newField.className = 'image-url-group';
        newField.innerHTML = `
            <input type="url" class="image-url" value="${url}" ${i === 0 ? 'required' : ''}>
            ${i > 0 ? '<button type="button" class="remove-image" onclick="removeImageField(this)">√ó</button>' : ''}
        `;
        container.appendChild(newField);
    });
    
    updateImagePreview();
    
    // Remove the book being edited
    books.splice(index, 1);
    localStorage.setItem('abhiLearnBooks', JSON.stringify(books));
    displayBooks();
}

// Initial display
displayBooks();
</script>
</body>
</html>

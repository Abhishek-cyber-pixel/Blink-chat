<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paper Upload & View</title>
</head>
<body style="font-family: Arial; margin: 30px;">

  <h2>📄 Upload Paper</h2>
  <input type="file" id="fileInput">
  <button onclick="uploadFile()">Upload</button>
  <p id="status"></p>

  <h2>📂 Uploaded Papers</h2>
  <div id="fileLinks"></div>

  <!-- Firebase Scripts -->
  <script type="module">
    // Import Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getStorage, ref, uploadBytes, getDownloadURL, listAll } 
      from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

    // 🔑 Your Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyARYU6-dTVfjQph4qvnzQq3H53sGwS48mg",
      authDomain: "new-prototype-llvhl.firebaseapp.com",
      projectId: "new-prototype-llvhl",
      storageBucket: "new-prototype-llvhl.appspot.com",
      messagingSenderId: "294603651419",
      appId: "1:294603651419:web:e9b6cc61a5f3de80a6027e"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    // 📤 Upload Function
    async function uploadFile() {
      const file = document.getElementById("fileInput").files[0];
      const status = document.getElementById("status");

      if (!file) {
        status.innerText = "⚠️ Please select a file first!";
        return;
      }

      const storageRef = ref(storage, "papers/" + file.name);

      try {
        await uploadBytes(storageRef, file);
        status.innerText = "✅ File uploaded successfully!";
        loadFiles(); // refresh list
      } catch (error) {
        status.innerText = "❌ Upload failed: " + error;
      }
    }

    // 📥 Load Files from Firebase
    async function loadFiles() {
      const listRef = ref(storage, "papers/");
      const res = await listAll(listRef);

      const container = document.getElementById("fileLinks");
      container.innerHTML = "";

      if (res.items.length === 0) {
        container.innerHTML = "<p>No papers uploaded yet.</p>";
        return;
      }

      res.items.forEach(async (itemRef) => {
        const url = await getDownloadURL(itemRef);
        const link = document.createElement("a");
        link.href = url;
        link.textContent = "📄 " + itemRef.name;
        link.target = "_blank";
        container.appendChild(link);
        container.appendChild(document.createElement("br"));
      });
    }

    // 🚀 Load files on page start
    loadFiles();
  </script>
</body>
</html>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="modal-content" id="modalContent">
    <!-- Upload content will be inserted dynamically -->
  </div>
</div>

<style>
/* Circular Loader for uploading */
.loader-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}

.circular-loader {
  width: 80px;
  height: 80px;
  border: 8px solid #f3f3f3;
  border-top: 8px solid #ffeb3b;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loader-text {
  font-weight: bold;
  color: #1e3c72;
  font-size: 1.1rem;
}
</style>

<script>
function uploadFileToFirebase(file) {
  const modalContent = document.getElementById("modalContent");
  
  // Show loader
  modalContent.innerHTML = `
    <div class="loader-container">
      <div class="circular-loader"></div>
      <div class="loader-text">Uploading...</div>
    </div>
  `;

  // Firebase Storage reference
  const storageRef = firebase.storage().ref('papers/' + file.name);
  const uploadTask = storageRef.put(file);

  // Upload progress
  uploadTask.on('state_changed', 
    (snapshot) => {
      // Optional: you can calculate progress percent here
      const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
      console.log("Upload Progress:", progress.toFixed(0) + "%");
    }, 
    (error) => {
      modalContent.innerHTML = `<h2>❌ Upload Failed</h2><p>${error.message}</p><button onclick="closeModal()">Close</button>`;
    }, 
    () => {
      uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
        modalContent.innerHTML = `
          <h2>✅ Uploaded Successfully!</h2>
          <p>File is available for everyone.</p>
          <button onclick="closeModal()">Close</button>
        `;
      });
    }
  );
}
</script>
